<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Welcome Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">

    <style>
        .hidden{
            display: none;
        }
        .card-table th,
        .card-table td{
            border: 1px solid #ddd;
            padding: 15px;
            text-align: left;
            width: 600px;
        }
        .card-table th, .card-table td {
            border: 1px solid #ddd;
            padding: 15px;
            text-align: left;
        }
        .btn-primary {
            margin-right: 50px;
            background-color: white;
            color: black;
            border-color: white;
            font-weight: normal;
        }
        .btn-primary:hover {
            background-color: #D5DBDB;
            color: black;
            border-color: #f2f2f2;
        }

        .btn-secondary {
            margin-right: 40px;
            background-color: white;
            font-weight: normal;
            color: black;
            border-color: white;
        }

        .btn-secondary:hover {
            background-color: #D5DBDB;
            color: black;
            border-color: #f2f2f2;
        }

        .user-circle {
            margin-left: 110px;
            margin-top: 45px;
            align-self: center;
            width: 140px;
            height: 140px;
            background-color: #003566;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .user-initial {
            font-size: 34px; /* Adjust font size as needed */
            justify-content: center;
            color: #fff; /* Text color inside the circle */
        }

        .card-text {
            font-size: 18px;
        }

        .card-title {
            color: darkslateblue;
        }

        .view-icon-group {
            display: flex;
            align-items: center;
            border: none;
            background-color:white;;
        }
        .fa-eye {
            border: none;
        }
        .fa-eye {
            width: 1.2em;
            height: 1.2em;
            fill: currentColor;
        }
        .view-btn-2 {
            border: none;
            background-color: white;
        }

        @media only screen and (max-width: 800px) {

            .container-fluid{
                margin-top: -20px;
            }
            .btn-primary{
                display: none;
            }
            .btn-secondary{
                display: none;
            }

            .btn-icon {
                background-color: transparent;
                border: none;
                cursor: pointer;
                padding: 5px;
                position: absolute;
                top: 25px; /* Adjust as needed */
                left: 10px; /* Adjust as needed */
            }
            .fa-times{
                margin-left: 10px; /* This will push the close icon to the right */
                cursor: pointer;
                font-size: 22px;
                color: black;
            }
            .btn-icon i {
                font-size: 22px;
                color: black;
            }

            .user-circle {
                margin-left: auto;
                margin-right: auto;
                margin-top: 20px; /* Adjust margin-top as needed */
                width: 100px;
                height: 100px;
                background-color: #003566;
                border-radius: 50%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .user-initial {
                font-size: 34px; /* Adjust font size as needed */
                color: #fff; /* Text color inside the circle */
            }
            .nav-page {
                position: fixed;
                top: 0;
                left: 0;
                width: 50%;
                height: 100%;
                background-color: #fff;
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
                display: flex;
                flex-direction: column;
                padding: 20px;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }

            .nav-card {

                height: 86px;
                /*box-shadow: 0px 0px 5px 0px #888888;*/
                margin-bottom: 40px;
                margin-top: 2px;
            }

            .nav-page a {
                /*top: 100px;*/
                display: block;
                margin-bottom: 10px;
                padding: 10px;
                text-align: center;
                text-decoration: none;
                color: #fff;
                font-size: 18px;
                background-color: #003566;
                border: none;
                border-radius: 5px;
                transition: background-color 0.3s ease;
            }

            .nav-page a:hover {
                background-color: #003566; /* Darker color on hover */
            }

            .nav-page card{
                margin-top: -20px;

            }



        }

        @media only screen and (min-width: 801px) {
            .btn-icon {
                display: none;
            }

            .nav-page {
                display: none;
            }

            .user-circle {
                margin-left: auto;
                margin-right: auto;
                margin-top: 20px; /* Adjust margin-top as needed */
                width: 125px;
                height: 125px;
                background-color: #003566;
                border-radius: 50%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .user-initial {
                font-size: 34px; /* Adjust font size as needed */
                color: #fff; /* Text color inside the circle */
            }
        }

    </style>

</head>

<body style="background-color: #f2f2f2">
<div style="background-color: #f2f2f2; padding: 20px;">
    <div class="container-fluid">
        <!-- First Row: Navigation Bar with Logo and Buttons -->
        <br>
        <div class="row" style="margin-top: auto">
            <div class="col">
                <div class="card w-100" style="border-radius: 0px; box-shadow: 0px 0px 5px 0px #888888;">
                    <div class="card-body d-flex justify-content-end align-items-center other-btn">
                        <div class="nav-menu" style="flex: 1;"></div>
                        <button class="btn btn-icon" onclick="toggleNav()">
                            <i class="fas fa-bars"></i>
                        </button>

                        <button class="btn btn-primary" th:if="${isStudent}"><a href="/welcome" style="text-decoration: none; color: black;">Home</a></button>
                        <button class="btn btn-primary" th:if="${isProfessor and not isCoordinator}"><a href="/welcome" style="text-decoration: none; color: black;">Home</a></button>
                        <button class="btn btn-primary" th:if="${isStudent}"><a href="/myProjects" style="text-decoration: none; color: black;">My Projects</a></button>
                        <button class="btn btn-primary" th:if="${isStudent}"><a href="/apply" style="text-decoration: none; color: black;">Apply for Projects</a></button>
                        <button class ="btn btn-primary"  th:if="${isProfessor}"><a href="/create" style="text-decoration: none; color: black;">Create</a></button>
                        <button class ="btn btn-primary"  th:if="${isProfessor}"><a href="/approve" style="text-decoration: none; color: black;">Approve</a></button>
                        <button class="btn btn-primary"  th:if="${isProfessor}"><a href="/myProjects" style="text-decoration: none; color: black;">My Projects</a></button>
<!--                        <button class="btn btn-primary" th:if="${isCoordinator and not isProfessor}""><a href="/welcome" style="display: none;">My Projects</a></button>-->
                        <!--
    <button class="btn btn-primary"  th:if="${isCoordinator}"><a href="/filter" style="text-decoration: none; color: black;">Filter</a></button>-->
                        <button class="btn btn-primary"  th:if="${isCoordinator}"><a href="/filter" style="text-decoration: none; color: black;">Switch To Coordinator</a></button>
                        <button class="btn btn-secondary" ><a href="/logout" style="text-decoration: none; color: black;">Logout</a></button>

                        <img src="https://iitj.ac.in/uploaded_docs/IITJ%20Logo__Smallest.jpg" alt="Your Logo" height="50" style="margin-right: 30px; transform: scale(1.4);" class="ml-2">
                    </div>

                </div>
            </div>
        </div>
        <br>
        <!-- Second Row: Two Columns -->
        <div class="row" style="margin-top: 20px">
            <div class="col-md-7 col-12 text-center text-md-left mb-3 mb-md-0">
                <div class="card mt-4">
                    <div class="card-body">
                        <h5 class="card-title">My Running Projects</h5>
                        <table class="table">
                            <thead>
                            <tr>
                                <th></th>
                                <th>Project Name</th>
                                <th th:if="${isStudent}">Professor</th>
                                <th th:if="${isProfessor}">Students</th>

                                <th class="hidden">Project Deadline</th>
                                <th class="hidden">Type</th>
                                <th class="hidden">Description</th>
                                <th class="hidden">Prerequisite</th>
                                <th class="hidden" th:if="${isStudent}"> Course Code </th>
                                <th class="hidden">Stipend</th>
                                <th class="hidden">Amount</th>
<!--students                -->
                                <!-- Add more columns for additional information -->
                            </tr>
                            </thead>
                            <tbody>
                            <!-- Iterate through the running projects -->
                            <tr th:each="project : ${myProjectsRunning}">
                                <td><button type="button" class="view-btn-2" onclick="showDetails(this)">
                                    <div class="view-icon-group-2">
                                        <i class="fa fa-eye" aria-hidden="true"></i>
                                    </div>
                                </button>
                                </td>
                                <td th:text="${project.getTitle()}"></td>
                                <td th:if="${isStudent}" th:text="${mapOfProjectAndProf.get(project).getName()}"></td>
                                <td th:if="${isProfessor}">
                                    <span th:each="student : ${mapOfProjectAndStudents.get(project)}">
                                        <span th:text="${student.getName()}"></span><br> <!-- Assuming 'name' is a property of the user -->
<!--                                        <span th:text="${student.email}"></span> &lt;!&ndash; Assuming 'email' is a property of the user &ndash;&gt;-->
                                        <!-- Add additional spans for other user properties as needed -->
                                    </span>
                                </td>

                                <td class="hidden" th:text="${project.getDeadline()}"></td>

                                <td class="hidden" th:text="${project.getProjectType()}"></td>
                                <td class="hidden" th:text="${project.getDescription()}"></td>
                                <td class="hidden" th:text="${project.getPreReq()}"></td>
                                <td th:if="${isStudent}" th:text = "${mapOfProjectAndCourseCode.get(project).getCode()}"></td>
                                <td class="hidden" th:text="${project.getStipendOption()}"></td>
                                <td class="hidden" th:text="${project.getStipendAmount()}"></td>

                                <!-- Add more columns for additional information -->
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <div class="col-md-3 col-12 text-center" style="margin-right: auto;">
                <div class="card" style="border-radius: 5px; box-shadow: 0px 0px 5px 0px #888888;">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${role}">Student</h5>
                        <div class="user-circle">
                            <p class="user-initial" th:text="${#strings.substring(name,0,1)}">N</p>
                        </div>
                        <p class="card-text" style="text-align: center;"><span th:text="${name}"></span></p>
                        <p class="card-text" style="text-align: left; font-size: unset">
                            <i class="fas fa-envelope" ></i> <span th:text="${email}"></span>
                        </p>
                        <p class="card-text" style="text-align: left; font-size: unset">
                            <i class="fas fa-user"></i> <span th:text="${user_name}"></span>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="nav-page">
            <div class="card nav-card w-100" style="border-radius: 0px; box-shadow: 0px 0px 5px 0px #888888;">
                <div class="card-body d-flex justify-content-end align-items-center">
                    <div class="nav-menu" style="flex: 1;"></div>

                    <button class="btn btn-icon" onclick="toggleNav()" style="margin-left:auto ">
                        <i class="fas fa-times"></i>
                    </button>
                    <button class="btn btn-columns" ></button>
                </div>
            </div>
            <a href="/welcome">Home</a>
            <a th:if="${isStudent}" href="/myProjects">My Projects</a>
            <a th:if="${isStudent}" href="/apply">Apply for Projects</a>
            <a th:if="${isProfessor}" href="/create">Create</a>
            <a th:if="${isProfessor}" href="/approve">Approve</a>
            <a th:if="${isProfessor}" href="/myProjects">My Projects</a>
            <a th:if="${isCoordinator}" href="/filter">Filter</a>
            <a href="/logout">Logout</a>
        </div>


    </div>
</div>

</body>

</html>

<!-- Updated JavaScript script -->
<script>
    function toggleNav() {
        var navPage = document.querySelector('.nav-page');
        var navIcon = document.querySelector('.btn-icon');


        if (navPage.style.transform === 'translateX(-100%)' || navPage.style.transform === '') {
            // Show navigation page
            navPage.style.transform = 'translateX(0)';
            // navIcon.innerHTML = '<i class="fas fa-times"></i>'; // Change icon to 'times' (cross)
        } else {
            // Hide navigation page
            navPage.style.transform = 'translateX(-100%)';
            navIcon.innerHTML = '<i class="fas fa-bars"></i>'; // Change icon back to 'bars'
        }
    }

    function showDetails(button) {
        const row = button.closest('tr');
        const table = row.closest('table');

        const popupWidth = 1220;
        const popupHeight = 800;
        const left = (window.innerWidth - popupWidth) / 2;
        const top = (window.innerHeight - popupHeight) / 2;

        const popupWindow = window.open('', 'ProjectDetails', `width=${popupWidth},height=${popupHeight},left=${left},top=${top}`);

        // Create a new table for the popup
        const popupTable = document.createElement('table');
        popupTable.className = 'card-table';

        // Add a header row to the popup table
        const headerRow = document.createElement('tr');
        table.querySelector('thead').querySelectorAll('th.hidden').forEach((hiddenTh) => {
            const newTh = document.createElement('th');
            newTh.textContent = hiddenTh.textContent;
            headerRow.appendChild(newTh);
        });
        popupTable.appendChild(headerRow);

        // Add the clicked row's hidden cell data to the popup table
        const newRow = document.createElement('tr');
        row.querySelectorAll('td.hidden').forEach((hiddenCell) => {
            const newCell = document.createElement('td');
            newCell.textContent = hiddenCell.textContent;
            newRow.appendChild(newCell);
        });
        popupTable.appendChild(newRow);

        // Add the popup table to the popup window
        popupWindow.document.write(`
      <html lang="">
      <head>
        <title>Project Details</title>
        <style>
          /* Add any additional styling here */
          ${document.head.innerHTML}
        </style>
      </head>
      <body>
        <h2>Project Details</h2>
        ${popupTable.outerHTML}
      </body>
      </html>
    `);
    }

</script>

